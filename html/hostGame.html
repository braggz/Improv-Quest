<h1 style="text-align:center;" id="title"></h1>
<h1 style="text-align:center;" id="playersJoined">Players Joined: 0</h1>
<button onclick="stop()" value="true">Stop</button>

<script>
	var bool = false;
	var uuid;
	var intervalId;
	var count = 0;
	const ws = new WebSocket('ws://localhost:9898/');
	 window.addEventListener('load', function () {
		
	
		
	});
	const queryString = window.location.search;
		const urlParams = new URLSearchParams(queryString);
		var hostName = urlParams.get('title');
		document.getElementById("title").innerHTML = hostName;
		var data = {
		action:"createGame",
		title:hostName
		}
		ws.onopen = function() {
			console.log('WebSocket Client Connected');
			ws.send(JSON.stringify(data));
		};
	ws.onmessage = function(e) {
		console.log(JSON.parse(e.data));
	  parseResponse(JSON.parse(e.data));
	};
	function loop(){
		intervalId = window.setInterval(function(){
			var data = {
				action:"checkStatus",
				gameId:uuid
			}
			ws.send(JSON.stringify(data));
		}, 50);	
	}
	
	function parseResponse(data){
		if(data.action == "createGame"){
			uuid = data.uuid;
			loop();
		}
		else if(data.action == "checkStatus"){
			if(data.data.activePlayers > count){
				count = data.data.activePlayers;
				document.getElementById("playersJoined").innerHTML = "Players Joined: "+count;
			}
		}
	}
	function stop(){
	clearInterval(intervalId) ;
	}
	function start(){
	}
	
</script>